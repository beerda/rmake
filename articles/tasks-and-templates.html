<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tasks and Templates • rmake</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tasks and Templates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rmake</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/build-rules.html">Build Rules</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started with rmake</a></li>
    <li><a class="dropdown-item" href="../articles/project-management.html">rmake Project Management</a></li>
    <li><a class="dropdown-item" href="../articles/tasks-and-templates.html">Tasks and Templates</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/beerda/rmake/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tasks and Templates</h1>
                        <h4 data-toc-skip class="author">Michal
Burda</h4>
            
            <h4 data-toc-skip class="date">2025-12-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/beerda/rmake/blob/master/vignettes/tasks-and-templates.Rmd" class="external-link"><code>vignettes/tasks-and-templates.Rmd</code></a></small>
      <div class="d-none name"><code>tasks-and-templates.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette covers advanced features of <code>rmake</code> that
help manage complex build processes: <strong>tasks</strong> for
organizing and selectively executing groups of rules, and
<strong>templates</strong> for efficiently generating multiple similar
rules with parameterization.</p>
<p>For basic usage and an introduction to rmake, see the <strong>Getting
Started with rmake</strong> vignette. For information on specific rule
types, see the <strong>Build Rules</strong> vignette. For project
management basics, see the <strong>rmake Project Management</strong>
vignette.</p>
</div>
<div class="section level2">
<h2 id="tasks">Tasks<a class="anchor" aria-label="anchor" href="#tasks"></a>
</h2>
<p>Tasks allow grouping rules that can be executed together. Each rule
is a member of the <code>"all"</code> task by default. Rules can belong
to multiple tasks.</p>
<div class="section level3">
<h3 id="executing-tasks">Executing Tasks<a class="anchor" aria-label="anchor" href="#executing-tasks"></a>
</h3>
<p>Execute a task:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/make.html">make</a></span><span class="op">(</span><span class="st">'all'</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/make.html">make</a></span><span class="op">(</span><span class="st">'preview'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="assigning-rules-to-tasks">Assigning Rules to Tasks<a class="anchor" aria-label="anchor" href="#assigning-rules-to-tasks"></a>
</h3>
<p>Assign rules to tasks:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/beerda/rmake" class="external-link">rmake</a></span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"preprocess.R"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"data.rds"</span>,</span>
<span>  <span class="st">"data.rds"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/markdownRule.html">markdownRule</a></span><span class="op">(</span><span class="st">"preview.Rmd"</span>, task <span class="op">=</span> <span class="st">"preview"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>    <span class="st">"preview.pdf"</span>,</span>
<span>  <span class="st">"data.rds"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/markdownRule.html">markdownRule</a></span><span class="op">(</span><span class="st">"final.Rmd"</span>, task <span class="op">=</span> <span class="st">"final"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>    <span class="st">"final.pdf"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/makefile.html">makefile</a></span><span class="op">(</span><span class="va">job</span>, <span class="st">"Makefile"</span><span class="op">)</span></span></code></pre></div>
<p>Running <code>make("preview")</code> creates <code>data.rds</code>
and <code>preview.pdf</code> but not <code>final.pdf</code>.</p>
</div>
<div class="section level3">
<h3 id="use-cases-for-tasks">Use Cases for Tasks<a class="anchor" aria-label="anchor" href="#use-cases-for-tasks"></a>
</h3>
<p>Tasks are useful for:</p>
<ul>
<li>
<strong>Incremental development</strong>: Create a “preview” task
for quick iterations and a “final” task for complete analysis</li>
<li>
<strong>Different outputs</strong>: Separate tasks for different
report formats or audiences</li>
<li>
<strong>Testing</strong>: Create a “test” task that runs on sample
data before processing the full dataset</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="parameterized-execution">Parameterized Execution<a class="anchor" aria-label="anchor" href="#parameterized-execution"></a>
</h2>
<p>Pass parameters to scripts via the <code>params</code> argument:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/beerda/rmake" class="external-link">rmake</a></span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"fit.R"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"out-0.1.rds"</span>,</span>
<span>  <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"fit.R"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"out-0.2.rds"</span>,</span>
<span>  <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"fit.R"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"out-0.3.rds"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/makefile.html">makefile</a></span><span class="op">(</span><span class="va">job</span>, <span class="st">"Makefile"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="accessing-parameters-in-scripts">Accessing Parameters in Scripts<a class="anchor" aria-label="anchor" href="#accessing-parameters-in-scripts"></a>
</h3>
<p>Parameters are available in scripts as the <code>params</code> global
variable:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit.R</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">params</span><span class="op">)</span></span>
<span><span class="co"># List of 5</span></span>
<span><span class="co">#  $ .target : chr "out-0.1.rds"</span></span>
<span><span class="co">#  $ .script : chr "fit.R"</span></span>
<span><span class="co">#  $ .depends: chr "data.csv"</span></span>
<span><span class="co">#  $ .task   : chr "all"</span></span>
<span><span class="co">#  $ alpha   : num 0.1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-getparam">Using getParam()<a class="anchor" aria-label="anchor" href="#using-getparam"></a>
</h3>
<p>Use <code><a href="../reference/getParam.html">getParam()</a></code> to access parameters safely:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/beerda/rmake" class="external-link">rmake</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">".depends"</span><span class="op">)</span></span>
<span><span class="va">resultName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">".target"</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">"alpha"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use parameters...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Processing with alpha ="</span>, <span class="va">alpha</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/getParam.html">getParam()</a></code> with default values:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">".depends"</span>, <span class="st">"data.csv"</span><span class="op">)</span></span>
<span><span class="va">resultName</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">".target"</span>, <span class="st">"result.rds"</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getParam.html">getParam</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="built-in-parameters">Built-in Parameters<a class="anchor" aria-label="anchor" href="#built-in-parameters"></a>
</h3>
<p>Every rule automatically has the following parameters available:</p>
<ul>
<li>
<code>.target</code> - The target file(s) being created</li>
<li>
<code>.script</code> - The script being executed</li>
<li>
<code>.depends</code> - The dependency file(s)</li>
<li>
<code>.task</code> - The task name(s)</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="rule-templates">Rule Templates<a class="anchor" aria-label="anchor" href="#rule-templates"></a>
</h2>
<p>Rule templates avoid repetitive rule definitions using
<code><a href="../reference/expandTemplate.html">expandTemplate()</a></code>. This is particularly useful when you need
to run the same analysis with different parameters or on different
datasets.</p>
<div class="section level3">
<h3 id="simple-template">Simple Template<a class="anchor" aria-label="anchor" href="#simple-template"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="st">"data-$[NUM].csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"process.R"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="st">"result-$[NUM].csv"</span></span>
<span><span class="va">variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NUM <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expandTemplate.html">expandTemplate</a></span><span class="op">(</span><span class="va">tmpl</span>, <span class="va">variants</span><span class="op">)</span></span></code></pre></div>
<p>This creates 99 rules, one for each value of <code>NUM</code>.</p>
</div>
<div class="section level3">
<h3 id="template-with-multiple-variables">Template with Multiple Variables<a class="anchor" aria-label="anchor" href="#template-with-multiple-variables"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>DATA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dataSimple"</span>, <span class="st">"dataComplex"</span><span class="op">)</span>,</span>
<span>                        TYPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lm"</span>, <span class="st">"rf"</span>, <span class="st">"nnet"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">variants</span><span class="op">)</span></span>
<span><span class="co">#&gt;          DATA TYPE</span></span>
<span><span class="co">#&gt; 1  dataSimple   lm</span></span>
<span><span class="co">#&gt; 2 dataComplex   lm</span></span>
<span><span class="co">#&gt; 3  dataSimple   rf</span></span>
<span><span class="co">#&gt; 4 dataComplex   rf</span></span>
<span><span class="co">#&gt; 5  dataSimple nnet</span></span>
<span><span class="co">#&gt; 6 dataComplex nnet</span></span>
<span></span>
<span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="st">"$[DATA].csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"fit-$[TYPE].R"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>  <span class="st">"result-$[DATA]_$[TYPE].csv"</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expandTemplate.html">expandTemplate</a></span><span class="op">(</span><span class="va">tmpl</span>, <span class="va">variants</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; (fit-lm.R, dataSimple.csv) -&gt; R -&gt; (result-dataSimple_lm.csv)</span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; (fit-lm.R, dataComplex.csv) -&gt; R -&gt; (result-dataComplex_lm.csv)</span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; (fit-rf.R, dataSimple.csv) -&gt; R -&gt; (result-dataSimple_rf.csv)</span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; (fit-rf.R, dataComplex.csv) -&gt; R -&gt; (result-dataComplex_rf.csv)</span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; (fit-nnet.R, dataSimple.csv) -&gt; R -&gt; (result-dataSimple_nnet.csv)</span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; (fit-nnet.R, dataComplex.csv) -&gt; R -&gt; (result-dataComplex_nnet.csv)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="combining-templates-with-parameters">Combining Templates with Parameters<a class="anchor" aria-label="anchor" href="#combining-templates-with-parameters"></a>
</h3>
<p>Duplicate rules are automatically removed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"pre.R"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"pre.rds"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"comp.R"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="st">"$[NUM]"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="st">"result-$[NUM].csv"</span></span>
<span><span class="va">variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>NUM <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expandTemplate.html">expandTemplate</a></span><span class="op">(</span><span class="va">tmpl</span>, <span class="va">variants</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in expandTemplate(tmpl, variants): Converting all values in `vars` to</span></span>
<span><span class="co">#&gt; character vectors.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; (pre.R, data.csv) -&gt; R -&gt; (pre.rds)</span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; (comp.R, pre.rds) -&gt; R -&gt; (result-1.csv)</span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; (comp.R, pre.rds) -&gt; R -&gt; (result-2.csv)</span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; (comp.R, pre.rds) -&gt; R -&gt; (result-3.csv)</span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; (comp.R, pre.rds) -&gt; R -&gt; (result-4.csv)</span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; (comp.R, pre.rds) -&gt; R -&gt; (result-5.csv)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="template-variables-in-parameters">Template Variables in Parameters<a class="anchor" aria-label="anchor" href="#template-variables-in-parameters"></a>
</h3>
<p>Template variables (like <code>$[NUM]</code>) can be used in: - File
names (targets and dependencies) - Script names - Parameters passed to
rules</p>
</div>
<div class="section level3">
<h3 id="common-pitfall-multiple-rules-for-same-target">Common Pitfall: Multiple Rules for Same Target<a class="anchor" aria-label="anchor" href="#common-pitfall-multiple-rules-for-same-target"></a>
</h3>
<p>Warning: Different rules producing the same target will cause an
error:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="st">"data-$[TYPE].csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/markdownRule.html">markdownRule</a></span><span class="op">(</span><span class="st">"report.Rmd"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"report.pdf"</span></span>
<span><span class="va">variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>TYPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expandTemplate.html">expandTemplate</a></span><span class="op">(</span><span class="va">tmpl</span>, <span class="va">variants</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">job</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; (report.Rmd, data-a.csv) -&gt; markdown -&gt; (report.pdf)</span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; (report.Rmd, data-b.csv) -&gt; markdown -&gt; (report.pdf)</span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; (report.Rmd, data-c.csv) -&gt; markdown -&gt; (report.pdf)</span></span>
<span></span>
<span><span class="co"># This would error:</span></span>
<span><span class="co"># makefile(job)</span></span>
<span><span class="co"># Error: Multiple rules detected for the same target</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="combining-tasks-and-templates">Combining Tasks and Templates<a class="anchor" aria-label="anchor" href="#combining-tasks-and-templates"></a>
</h2>
<p>You can combine tasks and templates for powerful workflow
management:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create template for different models</span></span>
<span><span class="va">tmpl</span> <span class="op">&lt;-</span> <span class="st">"data.csv"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"fit-$[MODEL].R"</span>, params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"$[MODEL]"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>  <span class="st">"model-$[MODEL].rds"</span></span>
<span></span>
<span><span class="co"># Expand for different models</span></span>
<span><span class="va">variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>MODEL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"rf"</span>, <span class="st">"xgboost"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">training_job</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/expandTemplate.html">expandTemplate</a></span><span class="op">(</span><span class="va">tmpl</span>, <span class="va">variants</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add evaluation tasks</span></span>
<span><span class="va">eval_job</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model-linear.rds"</span>, <span class="st">"model-rf.rds"</span>, <span class="st">"model-xgboost.rds"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/rRule.html">rRule</a></span><span class="op">(</span><span class="st">"evaluate.R"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"evaluation.rds"</span>,</span>
<span>  <span class="st">"evaluation.rds"</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/markdownRule.html">markdownRule</a></span><span class="op">(</span><span class="st">"report.Rmd"</span>, task <span class="op">=</span> <span class="st">"report"</span><span class="op">)</span> <span class="op"><a href="../reference/grapes-greater-than-greater-than-grapes.html">%&gt;&gt;%</a></span> <span class="st">"report.pdf"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all rules</span></span>
<span><span class="va">job</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">training_job</span>, <span class="va">eval_job</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/makefile.html">makefile</a></span><span class="op">(</span><span class="va">job</span>, <span class="st">"Makefile"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="for-tasks">For Tasks<a class="anchor" aria-label="anchor" href="#for-tasks"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Use meaningful names</strong>: Choose task names that
clearly describe their purpose</li>
<li>
<strong>Keep “all” minimal</strong>: Only include essential outputs
in the default “all” task</li>
<li>
<strong>Create incremental tasks</strong>: Build up complexity with
tasks like “quick”, “full”, “validate”</li>
</ol>
</div>
<div class="section level3">
<h3 id="for-templates">For Templates<a class="anchor" aria-label="anchor" href="#for-templates"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Use data frames for variants</strong>: This makes it easy to
generate all combinations with <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code>
</li>
<li>
<strong>Test with small variants first</strong>: Before generating
hundreds of rules, test with 2-3 variants</li>
<li>
<strong>Use consistent naming</strong>: Develop a naming convention
for template variables</li>
<li>
<strong>Document your templates</strong>: Add comments explaining
what each template generates</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette covered:</p>
<ul>
<li>
<strong>Tasks</strong>: Organizing rules into groups that can be
executed selectively</li>
<li>
<strong>Parameterized Execution</strong>: Passing parameters to
scripts for flexible processing</li>
<li>
<strong>Rule Templates</strong>: Efficiently generating multiple
similar rules</li>
<li>
<strong>Combining Features</strong>: Using tasks and templates
together for complex workflows</li>
</ul>
<p>For more information on basic usage and rule types, see the other
vignettes: - “Getting Started with rmake” - “rmake Project Management” -
“Build Rules”</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michal Burda.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
